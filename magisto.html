<!DOCTYPE html>
<html>
<head>
    <title>Magisto OAuth Flow Simulator</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .step { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .warning { background: #fff3cd; color: #856404; }
        .danger { background: #f8d7da; color: #721c24; }
        button { background: #4285F4; color: white; padding: 15px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üéØ Magisto OAuth Flow Simulator</h1>
    <p>This demonstrates how a real OAuth flow can be hijacked through iOS scheme confusion.</p>

    <div class="step">
        <h3>Step 1: User initiates Google login in Magisto</h3>
        <button onclick="startOAuthFlow()">üîê Start Google OAuth Flow</button>
    </div>

    <div id="flowSteps" style="display: none;">
        <div class="step">
            <h3>Step 2: Magisto redirects to Google</h3>
            <p>URL: <code>https://accounts.google.com/o/oauth2/v2/auth?client_id=774247004952-...&redirect_uri=com.googleusercontent.apps.774247004952-...://oauthredirect</code></p>
        </div>

        <div class="step warning">
            <h3>Step 3: User approves permissions in Google</h3>
            <p>User sees Google's permission screen and clicks "Allow"</p>
        </div>

        <div class="step danger">
            <h3>Step 4: Google redirects back to Magisto</h3>
            <p>Google sends: <code>com.googleusercontent.apps.774247004952-...://oauthredirect?code=REAL_OAUTH_CODE</code></p>
        </div>

        <div class="step danger">
            <h3>Step 5: üö® INTERCEPTION!</h3>
            <p>Instead of Magisto, the malicious app intercepts the OAuth code</p>
            <button onclick="triggerHijack()">üéØ Simulate Interception</button>
        </div>
    </div>

    <script>
        function startOAuthFlow() {
            document.getElementById('flowSteps').style.display = 'block';
        }

        function triggerHijack() {
            // This is the exact URL that Google would redirect to
            const hijackUrl = 'com.googleusercontent.apps.774247004952-i336pf8c7ak4acd8sraf4d24fn3npscf://oauthredirect?' +
                'code=4/0Ade5oVeREAL_GOOGLE_OAUTH_CODE_123456789&' +
                'scope=email%20profile%20openid&' +
                'authuser=0&' +
                'state=magisto_app_state&' +
                'prompt=none';

            window.location.href = hijackUrl;
        }
    </script>
</body>
</html>